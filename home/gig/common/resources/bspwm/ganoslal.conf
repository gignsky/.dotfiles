#!/bin/bash
# Ganoslal: 6-monitor desktop configuration (updated after GPU swap)
#
# Hardware Layout:
#   AMD GPU (card0): HDMI-A-1, HDMI-A-2 (top left/right 1080p)
#   NVIDIA GPU (card1): DP-5 (top center 1600x), HDMI-0 (bottom center 1600x), DP-1, DP-3 (bottom 1080p)
#
# Physical Monitor Layout:
#   [HDMI-A-1] [DP-5*] [HDMI-A-2]    ← Top row (AMD + NVIDIA center)
#   [DP-1] [HDMI-0] [DP-3]           ← Bottom row (NVIDIA)
#            (primary)
#
# Desktop Distribution (12 workspaces across 6 monitors):
#   • HDMI-A-1: I, II (Top-left AMD 1080p)
#   • DP-5: III, IV (Top-center NVIDIA 1600x - primary)
#   • HDMI-A-2: V, VI (Top-right AMD 1080p)
#   • DP-1: VII, VIII (Bottom-left NVIDIA 1080p)
#   • HDMI-0: IX, X (Bottom-center NVIDIA 1600x)
#   • DP-3: XI, XII (Bottom-right NVIDIA 1080p)

echo "Loading ganoslal 6-monitor configuration..."

# Detect available monitors
AVAILABLE_MONITORS=$(xrandr --listmonitors 2>/dev/null | grep -v "Monitors:" | awk '{print $4}' || true)
echo "Available monitors: $AVAILABLE_MONITORS"

# Configure monitors if they exist
if echo "$AVAILABLE_MONITORS" | grep -q "HDMI-A-1"; then
    bspc monitor HDMI-A-1 -d I II
    echo "Configured HDMI-A-1 (Top-left AMD) with desktops I, II"
fi

if echo "$AVAILABLE_MONITORS" | grep -q "DP-5"; then
    bspc monitor DP-5 -d III IV
    echo "Configured DP-5 (Top-center NVIDIA - primary) with desktops III, IV"
fi

if echo "$AVAILABLE_MONITORS" | grep -q "HDMI-A-2"; then
    bspc monitor HDMI-A-2 -d V VI
    echo "Configured HDMI-A-2 (Top-right AMD) with desktops V, VI"
fi

if echo "$AVAILABLE_MONITORS" | grep -q "DP-1"; then
    bspc monitor DP-1 -d VII VIII
    echo "Configured DP-1 (Bottom-left NVIDIA) with desktops VII, VIII"
fi

if echo "$AVAILABLE_MONITORS" | grep -q "HDMI-0"; then
    bspc monitor HDMI-0 -d IX X
    echo "Configured HDMI-0 (Bottom-center NVIDIA) with desktops IX, X"
fi

if echo "$AVAILABLE_MONITORS" | grep -q "DP-3"; then
    bspc monitor DP-3 -d XI XII
    echo "Configured DP-3 (Bottom-right NVIDIA) with desktops XI, XII"
fi

# Fallback for any unrecognized monitors
for monitor in $AVAILABLE_MONITORS; do
    if ! bspc query -M --names | grep -q "^$monitor$"; then
        echo "Configuring fallback monitor: $monitor"
        bspc monitor "$monitor" -d "FB$(echo $monitor | tr -d '-')"
    fi
done

CONFIGURED_MONITORS=$(bspc query -M --names | wc -l)
TOTAL_DESKTOPS=$(bspc query -D --names | wc -l)

echo "Ganoslal 6-monitor setup complete:"
echo "  Monitors configured: $CONFIGURED_MONITORS"
echo "  Total desktops: $TOTAL_DESKTOPS"
echo "  Target: 6 monitors, 12 desktops (AMD + NVIDIA dual-GPU)"
